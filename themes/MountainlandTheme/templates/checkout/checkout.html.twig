{% extends 'layout.html.twig' %}

{% block head %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/checkout.css') }}" />
{% endblock %}

{% block content %}
    <main class="checkout-page">
        <div class="checkout-breadcrumbs">
            <a href="{{ path('home') }}">Home</a> / <span>Checkout</span>
        </div>

        <header class="checkout-header">
            <div>
                <h1>Review your items</h1>
            </div>
        </header>

        <turbo-frame id="checkout-frame" data-turbo-action="advance" autoscroll data-autoscroll-block="start" data-autoscroll-behavior="smooth">
            <div class="checkout-steps" data-active-step="shipping">
                {% set stepClass = ' is-complete' %}
                {% for step in steps %}
                    {% if currentStep.slug == step.slug %}
                        {% set stepClass = ' is-active' %}
                    {% elseif stepClass == ' is-active' %}
                        {% set stepClass = '' %}
                    {% endif %}
                <a {% if stepClass == ' is-complete' %}href="/checkout/{{ step.slug }}" {% endif %}class="checkout-step{{ stepClass }}" data-step-target="{{ step.slug }}">
                    <span>{{ step.name }}</span>
                    <span class="step-arrow" aria-hidden="true">
                        <img src="{{ asset('var/assets/images/misc/white-arrow.png') }}" alt="" />
                    </span>
                </a>
                {% endfor %}
            </div>

            {{ form_start(form, {
                action: path('checkout-step', { step: app.request.attributes.get('step') }),
                attr: { 'data-turbo-frame': 'checkout-frame' }
            }) }}
            <div class="checkout-grid">
                <div class="checkout-form-sections">
                    {% block checkout_step %}{% endblock %}
                </div>

                <aside class="checkout-sidebar" id="cart-summary-frame" data-turbo-permanent>
                    <turbo-frame id="order-summary-frame" src="{{ path('checkout-summary-partial') }}" loading="lazy">
                        {% include 'checkout/_order_summary.html.twig' with { 'order': order } %}
                    </turbo-frame>
                </aside>
            </div>
            {{ form_end(form) }}

        </turbo-frame>
    </main>
{% endblock %}