{% extends 'layout.html.twig' %}

{% block head %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/checkout.css') }}" />
{% endblock %}

{% block scripts %}
    {{ parent() }}
    <script src="{{ asset('js/checkout.js') }}" defer></script>
{% endblock %}

{% block header %}
    {{ parent() }}
    {{ include('includes/header.html.twig') }}
{% endblock %}

{% block footer %}
    {{ include('includes/footer.html.twig') }}
{% endblock %}

{% block content %}
    <main class="checkout-page">
        <div class="checkout-breadcrumbs">
            <a href="{{ path('home') }}">Home</a> / <span>Checkout</span>
        </div>

        <header class="checkout-header">
            <div>
                <h1>Review your items</h1>
                <p class="lede">Update quantities, confirm shipping, and place your order.</p>
            </div>
        </header>

        <div class="checkout-steps" data-active-step="overview">
            <button class="checkout-step is-active" data-step-target="overview">
                <span>Shipping</span>
                <span class="step-arrow" aria-hidden="true">
                    <img src="{{ asset('var/assets/images/misc/white-arrow.png') }}" alt="" />
                </span>
            </button>
            <button class="checkout-step" data-step-target="payment">
                <span>Payment</span>
                <span class="step-arrow" aria-hidden="true">
                    <img src="{{ asset('var/assets/images/misc/white-arrow.png') }}" alt="" />
                </span>
            </button>
            <button class="checkout-step" data-step-target="review">
                <span>Review</span>
                <span class="step-arrow" aria-hidden="true">
                    <img src="{{ asset('var/assets/images/misc/white-arrow.png') }}" alt="" />
                </span>
            </button>
        </div>

        <div class="checkout-grid">
            <div class="checkout-form-sections">
                <section class="checkout-step-panel is-active" data-step="overview">
                    <article class="card">
                        <div id="saved-address-section" class="form-group">
                            <label for="saved-addresses">Shipping address</label>
                            <select id="saved-addresses">
                                <option value="">Select an address</option>
                                {% for address in addresses %}
                                    <option value="{{ loop.index0 }}">{{ address.line1 }}, {{ address.city }}, {{ address.state }} {{ address.zip }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group form-inline">
                            <label><input type="checkbox" id="add-new-address" /> Add new address</label>
                        </div>
                        <div id="new-address-section" class="new-address-form" style="display: none;">
                            {{ include('checkout/_address_form.html.twig', { 'prefix': 'new-address' }) }}
                        </div>
                    </article>

                    <article class="card">
                        <h3>Shipping method</h3>
                        <div class="form-group">
                            {% for shipMethod in shipMethods %}
                                <label class="option-row">
                                    <input type="radio" name="ship-method" value="{{ shipMethod.code }}" {% if loop.first %}checked{% endif %} />
                                    <span>{{ shipMethod.name }}</span>
                                    <span class="option-amount">${{ 0|number_format(2, '.', ',') }}</span>
                                </label>
                            {% endfor %}
                        </div>
                    </article>

                    <article class="card">
                        <div class="form-group">
                            <label for="requested-date">Requested ship date</label>
                            <input id="requested-date" type="date" />
                        </div>
                    </article>

                    <article class="card">
                        <h3>Customer information</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="attention">Attention</label>
                                <input id="attention" type="text" placeholder="Attention" />
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input id="phone" type="text" placeholder="+1 (555) 123-4567" maxlength="17" />
                            </div>
                            <div class="form-group">
                                <label for="company">Company Name</label>
                                <input id="company" type="text" placeholder="Company" />
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input id="email" type="email" placeholder="name@example.com" />
                            </div>
                            <div class="form-group">
                                <label for="po-number">PO Number</label>
                                <input id="po-number" type="text" placeholder="PO Number" />
                            </div>
                            <div class="form-group">
                                <label for="job-ref">Job Reference</label>
                                <input id="job-ref" type="text" placeholder="Job Reference" />
                            </div>
                        </div>
                    </article>

                    {{ include('checkout/_step_navigation.html.twig', {
                        'next_step': 'payment',
                        'next_text': 'Proceed to payment'
                    }) }}
                </section>

                <section class="checkout-step-panel" data-step="payment">
                    <article class="card payment-method-card is-expanded" data-payment-method="credit-card">
                        <div class="payment-method-header">
                            <label>
                                <input type="radio" name="payment-method" value="credit-card" checked />
                                <h3>Credit Card</h3>
                            </label>
                        </div>
                        <div class="payment-method-content">
                            <h4 class="section-subtitle">Card Information</h4>
                            <div class="form-group">
                                <label for="card-name">Cardholder name</label>
                                <input id="card-name" type="text" placeholder="Name on card" />
                            </div>
                            <div class="form-group">
                                <label for="card-number">Card number</label>
                                <input id="card-number" type="text" placeholder="1234 5678 9012 3456" />
                            </div>
                            <div class="form-group-row">
                                <div class="form-group">
                                    <label for="expiry-date">Expiration date</label>
                                    <input id="expiry-date" type="text" placeholder="MM/YY" />
                                </div>
                                <div class="form-group">
                                    <label for="cvv">CVV</label>
                                    <input id="cvv" type="text" placeholder="123" />
                                </div>
                            </div>

                            <h4 class="section-subtitle">Billing Address</h4>
                            {{ include('checkout/_address_form.html.twig', { 'prefix': 'billing' }) }}
                            <p class="fine-print">Your payment information is secure and encrypted.</p>
                        </div>
                    </article>

                    <article class="card payment-method-card" data-payment-method="net-due">
                        <div class="payment-method-header">
                            <label>
                                <input type="radio" name="payment-method" value="net-due" />
                                <h3>Net Due In Days</h3>
                            </label>
                        </div>
                        <div class="payment-method-content">
                            <div class="form-group">
                                <label for="net-due-days">Net due terms</label>
                                <select id="net-due-days">
                                    <option value="15">Net 15</option>
                                    <option value="30">Net 30</option>
                                    <option value="60">Net 60</option>
                                    <option value="90">Net 90</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="net-due-po">Purchase order number</label>
                                <input id="net-due-po" type="text" placeholder="PO Number" />
                            </div>
                            <p class="fine-print">Invoice will be sent to your registered email address.</p>
                        </div>
                    </article>

                    <article class="card payment-method-card" data-payment-method="pay-at-pickup">
                        <div class="payment-method-header">
                            <label>
                                <input type="radio" name="payment-method" value="pay-at-pickup" />
                                <h3>Pay at Pickup</h3>
                            </label>
                        </div>
                        <div class="payment-method-content">
                            <div class="info-box">
                                <p>You will pay for your order when you pick it up at the branch location. We accept cash, check, and card payments at pickup.</p>
                                <ul>
                                    <li>Payment due at time of pickup</li>
                                    <li>Accepted methods: Cash, Check, Credit/Debit Card</li>
                                    <li>Order must be picked up within 7 days</li>
                                </ul>
                            </div>
                        </div>
                    </article>

                    {{ include('checkout/_step_navigation.html.twig', {
                        'prev_step': 'overview',
                        'prev_text': 'Back to shipping',
                        'next_step': 'review',
                        'next_text': 'Proceed to review'
                    }) }}
                </section>

                <section class="checkout-step-panel" data-step="review">
                    {{ include('checkout/_review_info_section.html.twig', {
                        'title': 'Sold To',
                        'info_items': [
                            { 'label': 'Customer Name', 'source': 'attention', 'id': 'review-customer-name' },
                            { 'label': 'Account Name', 'source': 'company', 'id': 'review-account-name' },
                            { 'label': 'Phone Number', 'source': 'phone', 'id': 'review-sold-to-phone' },
                            { 'label': 'Email', 'source': 'email', 'id': 'review-sold-to-email' }
                        ],
                        'isDataBound': true
                    }) }}

                    {{ include('checkout/_review_info_section.html.twig', {
                        'title': 'Ship To',
                        'info_items': [
                            { 'label': 'Shipping Method', 'source': 'ship-method', 'id': 'review-shipping-method', 'type': 'radio' },
                            { 'label': 'Address', 'source': 'saved-addresses', 'id': 'review-ship-to-address', 'type': 'select' },
                            { 'label': 'Requested Ship Date', 'source': 'requested-date', 'id': 'review-ship-date' }
                        ],
                        'isDataBound': true
                    }) }}

                    {{ include('checkout/_review_info_section.html.twig', {
                        'title': 'Payment',
                        'info_items': [
                            { 'label': 'Payment Method', 'source': 'payment-method', 'id': 'review-payment-method', 'type': 'radio' },
                            { 'label': 'Billing Address', 'source': 'billing', 'id': 'review-billing-address', 'type': 'address' }
                        ],
                        'isDataBound': true
                    }) }}

                    {{ include('checkout/_step_navigation.html.twig', {
                        'prev_step': 'payment',
                        'prev_text': 'Back to payment'
                    }) }}
                </section>
            </div>

            <aside class="checkout-sidebar" id="order-summary-sidebar">
                {{ include('checkout/_order_summary.html.twig', {
                    'button_text': 'Proceed to payment',
                    'button_data_attribute': 'data-next-step="payment"',
                    'fine_print': 'You can review shipping and tax before placing your order.',
                    'step': 'overview'
                }) }}
            </aside>
        </div>
    </main>
{% endblock %}