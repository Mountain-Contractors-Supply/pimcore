name: Ensure Docker images build on PRs

on:
  pull_request:
    types: [opened, reopened, synchronize]

concurrency: 
  group: pr-docker-builds__${{ github.sha }}
  cancel-in-progress: true

jobs:
  build-images:
    name: Build Docker images
    uses: TorqIT/pimcore-github-actions-workflows/.github/workflows/docker-builds.yml@product-key
    permissions: 
      contents: read
      actions: read
    secrets:
      PIMCORE_PRODUCT_KEY: "${{ secrets.PIMCORE_PRODUCT_KEY }}"
      BUILD_TIME_SECRETS: >
        {
          "pimcore-instance-identifier": "${{ secrets.PIMCORE_INSTANCE_IDENTIFIER }}",
          "pimcore-encryption-secret": "${{ secrets.PIMCORE_ENCRYPTION_SECRET }}"
        }
      